(function(n){function r(a,b){var c={};c[B+"transform"]="translate3d("+a+"px, "+b+"px, 0px)";this.jScrollBox.css(c);this.current={x:a,y:b};this.cfg.scrollbar&&N.apply(this)}function N(){var a=this.current,b={},c=this.wrapperSize,d=0,k=this.dir,f=this.barSize;1!==k&&(d=a.x/this.maxScrollWidth*(c.width-f.x),b[B+"transform"]="translate3d("+d+"px, 0px, 0px)",this.jBarX.css(b));0!==k&&(d=a.y/this.maxScrollHeight*(c.height-f.y),b[B+"transform"]="translate3d(0px, "+d+"px, 0px)",this.jBarY.css(b))}function C(a){function b(){d=
+new Date-c;q[l.cfg.animation]?(k=q[l.cfg.animation](d,D,m,e),f=q[l.cfg.animation](d,g,n,e)):(k=q.linear(d,D,m,e),f=q.linear(d,g,n,e));if(d>=e)k=a.x,f=a.y,r.call(l,k,f),l.jBox.removeClass("active"),l._isAdded=!1,l.cfg.onscrollend&&l.cfg.onscrollend.apply(l);else{r.call(l,k,f);var p=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||setTimeout)(b);l.timer=p}}var c=+new Date,d=0,k,f,e="number"===typeof a.duration?a.duration:
0,D=this.current.x,g=this.current.y,m=a.x-D,n=a.y-g,l=this;b()}function t(){this.timer&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||clearTimeout)(this.timer)}function O(a){if(!this.cfg.ontouchstart||this.cfg.ontouchstart.apply(this)){t.apply(this);this.touched=!0;E.push(this);m=p=I(a);a=this.dir;var b=this.point,c=this.current;b.x=1===a?0:c.x;b.y=0===a?0:c.y;J=+new Date;F=!0;G=!1}}function K(a){if((e=E[0])&&e.touched){e._isAdded||
(e.jBox.addClass("active"),e._isAdded=!0);m=I(a);var b=e.dir,c=m.x-p.x,d=m.y-p.y,k=e.point;P.call(e,1===b?0:k.x+c,0===b?0:k.y+d);G||(Math.abs(c)<Math.abs(d)&&0===b&&(F=!1),G=!0);F&&a.preventDefault()}}function u(a){if(e){e.touched=!1;var b=m.x-p.x,c=m.y-p.y,d=e.point,k=e.cfg.deceleration,f=e.wrapperSize,h=e.dir;a=e.maxScrollWidth;var g=e.maxScrollHeight;if(0!==b||0!==c)v=+new Date-J,300>v?(b=1===h?{duration:0,destination:0}:L(d.x,d.x+b,v,e.maxScrollWidth,f.width,k),c=0===h?{duration:0,destination:0}:
L(d.y,d.y+c,v,e.maxScrollHeight,f.height,k),d=Math.max(b.duration,c.duration)):(b=1===h?{duration:0,destination:0}:{duration:300,destination:d.x+b},c=0===h?{duration:0,destination:0}:{duration:300,destination:d.y+c},d=300),b.destination=0<b.destination?(d+=300,0):b.destination<a?(d+=300,a):b.destination,c.destination=0<c.destination?(d+=300,0):c.destination<g?(d+=300,g):c.destination,e.scrollTo(b.destination,c.destination,d),e.cfg.ontouchend&&e.cfg.ontouchend.apply(e),e=null,E=[]}}function L(a,b,
c,d,e,f){b-=a;c=Math.abs(b)/c;var h;h=a+c*c/(2*f)*(0>b?-1:1);f=c/f;h<d?(h=e?d-e/2.5*(c/8):d,b=Math.abs(h-a),f=b/c):0<h&&(h=e?e/2.5*(c/8):0,b=Math.abs(a)+h,f=b/c);return{destination:Math.round(h),duration:f}}function P(a,b){r.call(this,a,b)}function Q(){var a=this;this.jScrollBox.on(g.start,function(b){O.call(a,b)});H||(n(document).on(g.move,K).on(g.end,u).on(g.cancel,u),H=!0)}function M(){var a,b,c,d,e,f,h,g;this.jScrollBox=this.jBox.children().eq(0);f={width:this.jBox.width(),height:this.jBox.height()};
a=this.jScrollBox.width();b=this.jScrollBox.height();c=f.width-a;d=f.height-b;h=this.cfg.x||0;g=this.cfg.y||0;e=0>c?0>d?2:0:0>d?1:-1;w++;this.dir=e;-1!==e&&(this.maxScrollWidth=c,this.maxScrollHeight=d,this.wrapperSize=f,this.point={x:h,y:g},this.cfg.scrollbar&&(this.jBox.append('<div class="scrollbar-x scrollbar"><div class="bar"></div></div><div class="scrollbar-y scrollbar"><div class="bar"></div></div>'),this.jScrollBarX=this.jBox.find(".scrollbar-x"),this.jScrollBarY=this.jBox.find(".scrollbar-y"),
this.barSize={x:f.width/a*f.width,y:f.height/b*f.height},this.jBarX=this.jScrollBarX.find(".bar").width(this.barSize.x),this.jBarY=this.jScrollBarY.find(".bar").height(this.barSize.y),0===e&&this.jScrollBarY.remove(),1===e&&this.jScrollBarX.remove()),Q.apply(this),r.call(this,h,g))}function x(a,b){this.jBox=n(a);this.cfg=n.extend({},R,b);M.apply(this);return this}var y="ontouchend"in document,z=window.PointerEvent||window.MSPointerEvent,A=function(a){return window.MSPointerEvent?"MSPointer"+a.charAt(9).toUpperCase()+
a.substr(10):a},g={click:"click",start:y?z?A("pointerdown"):"touchstart":"mousedown",move:y?z?A("pointermove"):"touchmove":"mousemove",end:y?z?A("pointerup"):"touchend":"mouseup",cancel:y?z?A("pointercancel"):"touchcancel":"mousecancel"},B=function(){var a=document.createElement("div").style,b="";""===a.WebkitTransform?b="-webkit-":""===a.MozTransform&&(b="-moz-");return b}(),q={"ease-out-back":function(a,b,c,d){return c*((a=a/d-1)*a*(2.70158*a+1.70158)+1)+b},"ease-out":function(a,b,c,d){return-c*
(a/=d)*(a-2)+b},linear:function(a,b,c,d){return a/d*c+b}},R={scrollbar:!0,animation:"ease-out",deceleration:6E-4},e=null,E=[],p={},m={},J,v,H=!1,F=!1,G=!1,w=0,I=function(a){a=a.originalEvent?a.originalEvent:a;var b=a.touches,c=0,d=0;b?(c=b[0].pageX,d=b[0].pageY):(c=a.clientX,d=a.clientY);return{x:c,y:d}};x.prototype={scrollTo:function(a,b,c){t.apply(this);C.call(this,{duration:c,x:a,y:b});this.jBox.addClass("active");this._isAdded=!0;return this},scrollXTo:function(a,b){t.apply(this);C.call(this,
{duration:b,x:a,y:this.current.y});this.jBox.addClass("active");this._isAdded=!0;return this},scrollYTo:function(a,b){t.apply(this);C.call(this,{duration:b,x:this.current.x,y:a});this.jBox.addClass("active");this._isAdded=!0;return this},refresh:function(a){var b=this.current.x,c=this.current.y;w--;this.jBox.find(".scrollbar").remove();this.cfg=n.extend(this.cfg,{x:b,y:c},a);M.apply(this);return this},destroy:function(){var a="";this.jBox.removeClass("active").off().find(".scrollbar").remove();for(a in this)delete this[a];
this.__proto__=null;w--;0===w&&(n(document).off(g.move,K).off(g.end,u).off(g.cancel,u),H=!1)}};"function"===typeof define&&define.amd?define([],function(){return x}):"undefined"!==typeof module&&module.exports?module.exports=x:window.NiceScroller=x})(window.jQuery||window.Zepto);